# This file was auto-generated by the Firebase CLI	
# https://github.com/firebase/firebase-tools	

name: Check CI and deploy a preview to Firebase Hosting on PR
'on': pull_request
jobs:	
  build_and_deploy:	
    runs-on: ubuntu-latest	
    steps:	
      - uses: actions/checkout@v2	

      - name: Install dependencies	
        run: yarn ci	

      - name: Configure for rinkeby	
        # if: github.ref == 'refs/heads/dev'	
        run: sh ./cli-process-env.sh rinkeby	

      - name: Build	
        run: yarn generate --fail-on-error	

      - name: Create a preview
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_ZKSYNC_VUE }}'
          target: stage	
          projectId: zksync-vue	
          channelID: live
        env:
          FIREBASE_CLI_PREVIEWS: hostingchannels
